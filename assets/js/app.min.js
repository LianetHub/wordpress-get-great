(() => { "use strict"; if ($(".preloader").length > 0) { let e = setInterval(function () { let t = $("#percentage"), s = parseInt(t.text()); s < 90 ? t.text(++s) : s < 95 && "interactive" === document.readyState ? t.text(95) : s < 99 && "complete" === document.readyState && t.text(99), s >= 99 && "complete" === document.readyState && (clearInterval(e), t.text(100), setTimeout(function () { $("body").removeClass("preloading").addClass("is-loaded") }, 300)) }, 20) } $(function () { $('a[href^="#"]').not("[data-fancybox]").on("click", function (e) { const t = this.getAttribute("href"); if ("#" === t) return; const s = $(t), i = $(".header"); if (s.length) { e.preventDefault(); const t = i.outerHeight() || 0, n = s.offset().top - t; $("html, body").stop().animate({ scrollTop: n }, 800) } }), "undefined" != typeof Fancybox && null !== Fancybox && Fancybox.bind("[data-fancybox]", { dragToClose: !1 }); const e = { Android: () => /Android/i.test(navigator.userAgent), BlackBerry: () => /BlackBerry/i.test(navigator.userAgent), iOS: () => /iPhone|iPad|iPod/i.test(navigator.userAgent), Opera: () => /Opera Mini/i.test(navigator.userAgent), Windows: () => /IEMobile/i.test(navigator.userAgent), any: function () { return this.Android() || this.BlackBerry() || this.iOS() || this.Opera() || this.Windows() } }; function t() { e.any() || $(window).width() < 992 ? $("body").removeClass("_pc").addClass("_touch") : $("body").removeClass("_touch").addClass("_pc") } t(), $(window).on("resize", () => { clearTimeout(window.resizeTimer), window.resizeTimer = setTimeout(() => { t() }, 100) }), $(document).on("click", e => { const t = $(e.target); if (t.closest(".menu__arrow").length) { const e = t.closest(".menu__arrow").parent(); e.hasClass("active") ? e.removeClass("active") : ($(".menu__item.active").removeClass("active"), e.addClass("active")) } if (t.closest(".menu__arrow").length || t.closest(".menu").length || $(".menu__item.active").removeClass("active"), t.closest(".menu").length || t.closest(".icon-menu").length || $(".menu__item.active").removeClass("active"), t.closest(".icon-menu").length && ($(".icon-menu").toggleClass("active"), $(".menu").toggleClass("menu--open"), $("body").toggleClass("menu-lock")), !$(".menu").hasClass("menu--open") || t.closest(".menu").length || t.closest(".icon-menu").length || ($(".icon-menu").removeClass("active"), $(".menu").removeClass("menu--open"), $("body").removeClass("menu-lock")), $(".menu").hasClass("menu--open") && t.closest(".menu__link").length && ($(".icon-menu").removeClass("active"), $(".menu").removeClass("menu--open"), $("body").removeClass("menu-lock")), t.closest(".about__tab").length) { const e = t.closest(".about__tab"), s = e.index(), i = e.closest(".about"); i.find(".about__tab").removeClass("active"), e.addClass("active"), i.find(".about__tab-content").removeClass("active").eq(s).addClass("active"), i.find(".about__image").removeClass("active").eq(s).addClass("active") } if (t.closest(".services__item").length) { const e = t.closest(".services__item"), s = e.data("project-id"), i = e.closest(".services"); i.find(".services__item").removeClass("active"), e.addClass("active"), i.find(".services__project").removeClass("active"), i.find(`[data-project-target="${s}"]`).addClass("active") } if (t.closest('[data-show-more="clients"]').length) { const e = t.closest('[data-show-more="clients"]'), s = e.closest(".clients__content").find(".clients__item.is-hidden"); s.addClass("is-animated"), s.css("display", "flex").hide().fadeIn(400).removeClass("is-hidden"), e.css("transition", "all 0.3s ease"), e.css({ transform: "scale(0)", opacity: "0", "pointer-events": "none" }), setTimeout(() => { e.remove() }, 400) } }); class s { constructor(e = {}) { this.tooltipClass = e.tooltipClass || "tooltip-default", this.activeClass = e.activeClass || "active-tooltip", this.offset = e.offset || 16, this.defaultPosition = e.defaultPosition || "bottom", this.onShow = e.onShow || null, this.onHide = e.onHide || null, this.$activeElement = null, this.$currentTooltip = null, this._initGlobalEvents() } _initGlobalEvents() { $(document).on("pointerdown.tooltipManager", e => { const t = $(e.target); this.$currentTooltip && (t.closest(`.${this.activeClass}`).length || t.closest(`.${this.tooltipClass}`).length || this.hide()) }), $(window).on("resize.tooltipManager scroll.tooltipManager", () => { this.$currentTooltip && this.$activeElement && this._positionTooltip(this.$activeElement, this.$currentTooltip) }) } show(e, t) { this.hide(), this.$activeElement = e, this.$activeElement.addClass(this.activeClass), this.$currentTooltip = $(`<div class="tooltip ${this.tooltipClass}"></div>`).html(t), $("body").append(this.$currentTooltip), this._positionTooltip(this.$activeElement, this.$currentTooltip), "function" == typeof this.onShow && this.onShow(this.$activeElement) } hide() { if (!this.$currentTooltip) return; this.$activeElement && this.$activeElement.removeClass(this.activeClass); const e = this.$activeElement; this.$currentTooltip.remove(), this.$currentTooltip = null, this.$activeElement = null, "function" == typeof this.onHide && this.onHide(e) } _positionTooltip(e, t) { const s = e[0].getBoundingClientRect(), i = t[0].getBoundingClientRect(), n = $(window), o = n.scrollTop(), a = n.scrollLeft(), l = n.height(); let r, c, d = s.left + a + s.width / 2 - i.width / 2; const p = s.bottom + this.offset + i.height < l, h = s.top - this.offset - i.height > 0; "bottom" === this.defaultPosition ? p ? (r = s.bottom + o + this.offset, c = "open-bottom") : (r = s.top + o - i.height - this.offset, c = "open-top") : h ? (r = s.top + o - i.height - this.offset, c = "open-top") : (r = s.bottom + o + this.offset, c = "open-bottom"), d < 10 && (d = 10), d + i.width > n.width() - 10 && (d = n.width() - i.width - 10), t.removeClass("open-top open-bottom").addClass(c).css({ top: r + "px", left: d + "px" }) } destroy() { this.hide(), $(document).off(".tooltipManager"), $(window).off(".tooltipManager") } } if ($(".promo__slider").length) { const n = $(".promo__tab-btn"), o = $(".promo"), a = $(".js-slide-source"), l = o.data("initial") || 0, r = e => { const t = e.slides[e.realIndex], s = $(t).attr("data-title") || "Слайд " + (e.realIndex + 1); a.val(s) }, c = new Swiper(".promo__slider", { initialSlide: l, slidesPerView: 1, effect: "fade", fadeEffect: { crossFade: !0 }, speed: 800, autoplay: { delay: 15e3, disableOnInteraction: !1, stopOnLastSlide: !1 }, on: { init: function (e) { let t = e.params.autoplay.delay; n.css("--counting-speed", t / 1e3 + "s"), n.each(function () { const e = $(this).find("rect")[0]; if (e) { const t = e.getTotalLength(); e.style.strokeDasharray = t, e.style.strokeDashoffset = t, e.style.transition = "none" } }), n.removeClass("active counting"), r(e), requestAnimationFrame(() => { requestAnimationFrame(() => { const t = e.realIndex, s = n.eq(t), i = s.find("rect")[0]; i && (s[0].offsetWidth, i.style.transition = ""), s.addClass("active counting") }) }) }, slideChangeTransitionStart: function (e) { const t = e.realIndex; let s = e.params.autoplay.delay, i = e.params.speed; if (n.css("--counting-speed", (s + i) / 1e3 + "s"), r(e), n.each(function () { const e = $(this).find("rect")[0]; if (e) { const t = e.getTotalLength(); $(this).removeClass("active counting"), e.style.transition = "none", e.style.strokeDashoffset = t } }), e.autoplay.running) { n[t].offsetWidth; const e = n.eq(t).find("rect")[0]; e && (e.style.transition = ""), n.eq(t).addClass("active counting") } else n.eq(t).addClass("active") } } }); n.on("click", function (e) { e.preventDefault(), c.autoplay.stop(), n.removeClass("counting"); const t = $(this).index(); c.slideTo(t) }) } $(".gratitudes__slider").length && new Swiper(".gratitudes__slider", { slidesPerView: 1.05, spaceBetween: 12, lazy: !0, navigation: { nextEl: ".gratitudes__next", prevEl: ".gratitudes__prev" }, pagination: { el: ".gratitudes__pagination", type: "fraction", formatFractionCurrent: function (e) { return e < 10 ? "0" + e : e }, formatFractionTotal: function (e) { return e < 10 ? "0" + e : e }, renderFraction: function (e, t) { return '<span class="' + e + '"></span> / <span class="' + t + '"></span>' } }, breakpoints: { 575.98: { slidesPerView: 2, spaceBetween: 16 }, 767.98: { slidesPerView: 3, spaceBetween: 20 }, 1199.98: { slidesPerView: 4, spaceBetween: 24 }, 1709.98: { slidesPerView: 5, spaceBetween: 32 } } }), $(".marquee__slider").each(function () { const e = $(this), t = "reverse" === e.attr("data-direction"), i = e.hasClass("marquee__slider--images"); let n = 0, o = !1; const a = new Swiper(this, { loop: !0, slidesPerView: "auto", observer: !0, observeParents: !0, freeMode: !0, allowTouchMove: !0, spaceBetween: i ? 32 : 12, slideToClickedSlide: !0, speed: 8e3, autoplay: { delay: 0, disableOnInteraction: !1, pauseOnMouseEnter: !1, reverseDirection: t }, breakpoints: { 767.98: { spaceBetween: i ? 64 : 12 } } }), l = () => { if (o) return; const e = window.getComputedStyle(a.wrapperEl), t = new WebKitCSSMatrix(e.transform); n = t.m41, a.autoplay.pause(), $(a.wrapperEl).css("transition", "none"), a.setTranslate(n), o = !0 }, r = () => { o && ($(a.wrapperEl).css("transition", ""), a.params.freeMode.enabled = !1, a.update(), a.params.freeMode.enabled = !0, a.update(), a.setTranslate(n), a.autoplay.resume(), o = !1) }, c = new s({ onShow: () => l(), onHide: t => { e.is(":hover") || r() } }); e.on("pointerenter", function (e) { "mouse" === e.originalEvent.pointerType && l() }), e.on("pointerleave", function (e) { "mouse" !== e.originalEvent.pointerType || c.$currentTooltip || r() }), e.find(".marquee__image[data-tooltip-content]").each(function () { const e = $(this), t = e.attr("data-tooltip-content"); e.on("pointerenter", function (s) { "mouse" === s.originalEvent.pointerType && c.show(e, t) }), e.on("click", function (s) { s.stopPropagation(), c.show(e, t) }) }) }), $(".services__slider").length && new class { constructor(e, t, s = 767.98) { this.$slider = $(e), this.options = t, this.init = !1, this.swiper = null, this.condition = s, this.$slider.length && (this.handleResize(), $(window).on("resize", () => this.handleResize())) } handleResize() { window.innerWidth <= this.condition ? this.init || (this.init = !0, this.swiper = new Swiper(this.$slider[0], this.options)) : this.init && (this.swiper.destroy(), this.swiper = null, this.init = !1) } }(".services__slider", { slidesPerView: "auto", slideToClickedSlide: !0, spaceBetween: 12 }, 1199.98), $(".numbers__slider").length && new Swiper(".numbers__slider", { slidesPerView: 5, spaceBetween: 4, speed: 2e4, loop: !0, autoplay: { delay: 0, disableOnInteraction: !1, pauseOnMouseEnter: !1 }, breakpoints: { 767.98: { spaceBetween: 12 } } }), $(".article__slider").each(function () { const e = $(this); new Swiper(this, { loop: !0, navigation: { nextEl: e.find(".article__next")[0], prevEl: e.find(".article__prev")[0] }, pagination: { el: e.find(".article__pagination")[0], clickable: !0 }, slidesPerView: 1 }) }), $(".articles__slider").length && new Swiper(".articles__slider", { slidesPerView: 1, spaceBetween: 24, watchOverflow: !0, navigation: { nextEl: ".articles__next", prevEl: ".articles__prev" }, breakpoints: { 767.98: { slidesPerView: 3 }, 1199.98: { slidesPerView: 3 }, 1661.98: { slidesPerView: 4 } } }); const i = $("[data-counter]"); if (i.length > 0) { const d = 3e3; function p(e) { let t = +e.text().replace(/\s+/g, ""); e.parent().css("min-width", e.parent().width()), e.text("0"); const s = performance.now(), i = n => { const o = n - s, a = Math.min(o / d, 1), l = t, r = a * l; e.text(h(Math.ceil(r))), a < 1 ? requestAnimationFrame(i) : (e.text(h(l)), e.parent().css("min-width", "")) }; requestAnimationFrame(i) } function h(e) { return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ") } i.each(function () { const e = $(this); new IntersectionObserver(function (t, s) { t[0].isIntersecting && (e.hasClass("animated") || p(e), e.addClass("animated")) }).observe(this) }) } if (window.formController = new class { constructor() { this.selectors = { field: ".form__field", errorClass: "_error", loadingClass: "_loading", requiredAttr: "[data-required]", fileInput: ".form__file-input", fileContainer: ".form__file", fileRemove: ".form__file-remove", submitBtn: '[type="submit"]' }, this.init() } init() { const e = this; $("form").each(function () { e.bindSubmit($(this)) }), $(document).on("input change", this.selectors.requiredAttr, e => { const t = $(e.target); (t.hasClass(this.selectors.errorClass) || t.closest(this.selectors.field).hasClass(this.selectors.errorClass)) && this.toggleErrorState(t, !0) }), $(document).on("keydown", 'input[type="tel"]', e => this.onPhoneKeyDown(e)), $(document).on("input", 'input[type="tel"]', e => this.onPhoneInput(e)), $(document).on("paste", 'input[type="tel"]', e => this.onPhonePaste(e)), $(document).on("focus", 'input[type="tel"]', e => { e.target.value || (e.target.value = "+7 ") }), $(document).off("change", this.selectors.fileInput).on("change", this.selectors.fileInput, e => this.handleFileChange(e)), $(document).off("click", this.selectors.fileRemove).on("click", this.selectors.fileRemove, e => this.handleFileRemove(e)) } bindSubmit(e) { e.on("submit", async t => { t.preventDefault(), this.validateForm(e) && await this.sendForm(e) }) } async sendForm(e, t = !1) { console.log("submit from form controller"); const s = e.attr("action"), i = e.attr("method") || "POST", n = new FormData(e[0]), o = e.find(this.selectors.submitBtn); o.addClass(this.selectors.loadingClass); try { const o = await fetch(s, { method: i, body: n }); if (o.ok) { const s = await o.json(); if (s.success) { if (e[0].reset(), e.find(".form__file-preview").remove(), e.find(".uploaded").removeClass("uploaded"), !t) { const e = Fancybox.getInstance(); e && e.destroy(), Fancybox.show([{ src: "#success-submitting", type: "inline" }]), "function" == typeof ym && ym(105964434, "reachGoal", "sendmail") } } else console.error("Ошибка логики сервера:", s.data.message), this.showErrorPopup() } else console.error("Ошибка сервера (HTTP статус)"), this.showErrorPopup() } catch (e) { console.error("Ошибка сети", e), this.showErrorPopup() } finally { o.removeClass(this.selectors.loadingClass) } } showErrorPopup() { const e = Fancybox.getInstance(); e && e.destroy(), Fancybox.show([{ src: "#error-submitting", type: "inline" }]) } validateField(e) { if (!e.is(":visible")) return this.toggleErrorState(e, !0), !0; const t = e.attr("type"), s = e.attr("name"), i = e.val() ? e.val().trim() : ""; let n = !0; return n = "checkbox" === t ? e.is(":checked") : "username" === s ? /^[^\d]+$/.test(i) && i.length > 1 : "tel" === t ? i.replace(/\D/g, "").length >= 11 : "email" === t ? /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i) : "city" === s ? i.length >= 2 : "address" === s ? i.length >= 5 : "" !== i, this.toggleErrorState(e, n), n } toggleErrorState(e, t) { e.closest(this.selectors.field).toggleClass(this.selectors.errorClass, !t), e.toggleClass(this.selectors.errorClass, !t) } validateForm(e) { let t = !0; const s = this; return e.find(this.selectors.requiredAttr).each(function () { s.validateField($(this)) || (t = !1) }), t } handleFileChange(e) { const t = $(e.currentTarget), s = t.closest(this.selectors.fileContainer), i = e.target.files[0]; if (s.find(".form__error").remove(), i && i.size > 10485760) return t.val(""), s.append('<span class="form__error">Файл слишком большой. <br> Максимальный размер — 10 МБ.</span>'), s.removeClass("uploaded"), void s.find(".form__file-preview").remove(); if (s.find(".form__file-preview").remove(), s.removeClass("uploaded"), i) { const e = i.type.match("image.*"), t = new FileReader; t.onload = t => { let n = ""; e && (n = `\n                <span class="form__file-image">\n                    <img src="${t.target.result}" alt="Превью" class="cover-image">\n                </span>\n            `); const o = `\n            <div class="form__file-preview">\n                ${n}\n                <span class="form__file-name">${i.name}</span>\n                <button type="button" aria-label="Удалить" class="form__file-remove icon-cross"></button>\n            </div>\n        `; s.append(o), s.addClass("uploaded") }, t.readAsDataURL(i) } } handleFileRemove(e) { e.preventDefault(), e.stopPropagation(); const t = $(e.currentTarget), s = t.closest(this.selectors.fileContainer), i = t.closest(".form__file-preview"); s.find(this.selectors.fileInput).val(""), s.removeClass("uploaded"), i.remove() } onPhoneInput(e) { const t = e.target; let s = t.value.replace(/\D/g, ""); const i = t.selectionStart; let n = ""; if (!s) return t.value = ""; t.value.length == i ? (s.length > 11 && (s = s.substring(0, 11)), n = "+7 (", s.length >= 2 && (n += s.substring(1, 4)), s.length >= 5 && (n += ") " + s.substring(4, 7)), s.length >= 8 && (n += "-" + s.substring(7, 9)), s.length >= 10 && (n += "-" + s.substring(9, 11)), t.value = n) : e.originalEvent.data && /\D/g.test(e.originalEvent.data) && (t.value = s) } onPhoneKeyDown(e) { const t = e.target.value.replace(/\D/g, ""); 8 == e.keyCode && 1 == t.length && (e.target.value = "") } onPhonePaste(e) { const t = e.target, s = t.value.replace(/\D/g, ""), i = e.originalEvent.clipboardData || window.clipboardData; if (i) { const e = i.getData("Text"); /\D/g.test(e) && (t.value = s) } } }, window.spollers = new class { constructor() { this.$spollersArray = $("[data-spollers]"), this.$spollersArray.length > 0 && this.init() } init() { const e = this.$spollersArray.filter((e, t) => !$(t).data("spollers").split(",")[0]); e.length > 0 && this.initSpollers(e); const t = this.$spollersArray.filter((e, t) => $(t).data("spollers").split(",")[0]); t.length > 0 && this.initMediaSpollers(t) } initMediaSpollers(e) { const t = []; e.each(function () { const e = $(this).data("spollers").split(","); t.push({ value: e[0], type: e[1] ? e[1].trim() : "max", item: $(this) }) }); let s = t.map(e => `(${e.type}-width: ${e.value}px),${e.value},${e.type}`); s = [...new Set(s)], s.forEach(e => { const s = e.split(","), i = s[1], n = s[2], o = window.matchMedia(s[0]), a = t.filter(e => e.value === i && e.type === n); o.addEventListener("change", () => { this.initSpollers(a, o) }), this.initSpollers(a, o) }) } initSpollers(e, t = !1) { (Array.isArray(e) ? e : e.toArray()).forEach(e => { const s = t ? e.item : $(e); !t || t.matches ? (s.addClass("_init"), this.initSpollerBody(s, !0), s.off("click", "[data-spoller]").on("click", "[data-spoller]", e => this.setSpollerAction(e))) : (s.removeClass("_init"), this.initSpollerBody(s, !1), s.off("click", "[data-spoller]")) }) } initSpollerBody(e, t = !0) { const s = e.find("[data-spoller]"); s.length > 0 && s.each(function () { const e = $(this), s = e.next(), i = e.parent(); t ? (e.removeAttr("tabindex"), e.hasClass("_active") ? i.addClass("_spoller-open") : (s.hide(), i.removeClass("_spoller-open"))) : (e.attr("tabindex", "-1"), s.show(), i.removeClass("_spoller-open")) }) } setSpollerAction(e) { const t = $(e.target), s = t.has("[data-spoller]") ? t : t.closest("[data-spoller]"), i = s.closest("[data-spollers]"), n = i.is("[data-one-spoller]"), o = s.next(), a = s.parent(); i.find(":animated").length || (n && !s.hasClass("_active") && this.hideSpollersBody(i), s.toggleClass("_active"), a.toggleClass("_spoller-open"), o.slideToggle(300)), e.preventDefault() } hideSpollersBody(e) { const t = e.find("[data-spoller]._active"); t.length && (t.removeClass("_active"), t.parent().removeClass("_spoller-open"), t.next().slideUp(300)) } }, window.dynamicAdapt = new class { constructor(e) { this.type = e, this.objects = [], this.daClassname = "_dynamic_adapt_", this.$nodes = $("[data-da]"), this.$nodes.length > 0 && this.init() } init() { this.$nodes.each((e, t) => { const s = $(t), i = s.data("da").trim().split(","), n = {}; n.element = s, n.parent = s.parent(), n.destination = $(i[0].trim()), n.breakpoint = i[1] ? i[1].trim() : "767", n.place = i[2] ? i[2].trim() : "last", n.index = this.indexInParent(n.parent, n.element), this.objects.push(n) }), this.arraySort(this.objects), this.mediaQueries = this.objects.map(e => `(${this.type}-width: ${e.breakpoint}px),${e.breakpoint}`).filter((e, t, s) => s.indexOf(e) === t), this.mediaQueries.forEach(e => { const t = e.split(","), s = window.matchMedia(t[0]), i = t[1], n = this.objects.filter(e => e.breakpoint === i); s.addEventListener("change", () => { this.mediaHandler(s, n) }), this.mediaHandler(s, n) }) } mediaHandler(e, t) { e.matches ? t.forEach(e => { e.index = this.indexInParent(e.parent, e.element), this.moveTo(e.place, e.element, e.destination) }) : t.forEach(e => { e.element.hasClass(this.daClassname) && this.moveBack(e.parent, e.element, e.index) }) } moveTo(e, t, s) { t.addClass(this.daClassname); const i = s.children(); "last" === e || e >= i.length ? s.append(t) : "first" !== e ? i.eq(e).before(t) : s.prepend(t) } moveBack(e, t, s) { t.removeClass(this.daClassname); const i = e.children(); i.eq(s).length > 0 ? i.eq(s).before(t) : e.append(t) } indexInParent(e, t) { return e.children().index(t) } arraySort(e) { "min" === this.type ? e.sort((e, t) => e.breakpoint === t.breakpoint ? e.place === t.place ? 0 : "first" === e.place || "last" === t.place ? -1 : "last" === e.place || "first" === t.place ? 1 : e.place - t.place : e.breakpoint - t.breakpoint) : e.sort((e, t) => e.breakpoint === t.breakpoint ? e.place === t.place ? 0 : "first" === e.place || "last" === t.place ? 1 : "last" === e.place || "first" === t.place ? -1 : t.place - e.place : t.breakpoint - e.breakpoint) } }("max"), $(".article__copy").length) { const u = new s({ tooltipClass: "tooltip-copy", defaultPosition: "top", offset: 10 }); let m = null; $(".article__copy").on("click", function (e) { e.preventDefault(); const t = $(this), s = t.attr("data-url"); s && navigator.clipboard.writeText(s).then(() => { u.show(t, "Скопировано"), m && clearTimeout(m), m = setTimeout(() => { u.hide() }, 1500) }).catch(e => { console.error("Ошибка при копировании: ", e) }) }) } }) })();